<%= render "/games/all_pages_nav" %>

<table>
  <caption>View Profile Details</caption>
  <tr>
    <td><strong>Email:</strong></td>
    <td><%= @current_user.email %></td>
  </tr>
  <tr>
    <td><strong>First Name:</strong></td>
    <td><%= @current_user.first_name %></td>
  </tr>
  <tr>
    <td><strong>Last Name:</strong></td>
    <td><%= @current_user.last_name %></td>
  </tr>
  <th scope="row" colspan="2">Active Roles</th>

 <!-- Form for updating roles -->
<%= form_with(model: @settings, url: setting_path(@settings), method: :patch, local: true) do %>
    <% @roles.each do |role| %>
      <tr>
        <td>
          <% if ["Puzzle Setter", "Puzzle Aesthetician"].include?(role.role) %>
            <!-- Display the role with the associated game -->
            <strong>
              <%= role.role %> 
              <% if role.game %>
                for <%= role.game.name %>
              <% else %>
                for No game associated
              <% end %>
            </strong>
          <% else %>
            <strong><%= role.role %></strong>
          <% end %>
        </td>
        <td>
          <label class="switch">
            <input type="checkbox" 
                   name="roles[]" 
                   value="<%= role.role %>" 
                   <%= @settings.roles.include?(role.role) ? 'checked' : '' %> />
            <span class="slider round"></span>
          </label>
        </td>
      </tr>
    <% end %>
    
    <tr>
      <td colspan="3">
        <%= submit_tag "Update Active Roles", class: "btn btn-login" %>
      </td>
    </tr>
<% end %>

</table>

<!-- Clear any floating elements if needed -->
<div style="clear: both;"></div>

<div class='user-options'>
  <%= button_to "Edit Account", edit_user_path(@current_user), method: :get, class:"btn btn-login" %>
  <%= button_to "Delete Account", user_path(@current_user), method: :delete, data: {confirm: 'Are you sure?'}, class: "btn btn-login" %>
</div>

<br><br>